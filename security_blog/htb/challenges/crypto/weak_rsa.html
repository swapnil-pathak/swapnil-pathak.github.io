<!DOCTYPE html>
<html lang="en"><meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
		integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
	  integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css"
	  crossorigin="anonymous">
	<link rel="stylesheet" href="/css/simple.css">

	<head>
		<link rel="stylesheet" href="/font-awesome-4.7.0/css/font-awesome.min.css">

		<title>Weak RSA | Swapnil Pathak</title>
	</head>

	<!-- Start body -->
	<body>
    <div class="container-responsive fixed-top border-bottom" style="background-color: #fff;">
			<div class="container">
      	<nav class="navbar navbar-expand-lg navbar-light px-0">
          <div class="col-sm-3 text-center px-0">
            <a class="navbar-brand font-weight-bold" href="/about/">About</a>
          </div>

          <div class="col-sm-8 ml-auto px-0">

            <ul class="navbar-nav">
              <li class="nav-item dropdown">
                <a class="navbar-toggler dropdown-toggle" href="/" id="navbardrop" data-toggle="dropdown">Menu</a>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="/">Home</a>
                  <a class="dropdown-item" href="/about/">About</a>
                  <a class="dropdown-item" href="/security_blog/">Security Blog</a>
                </div>
              </li>
            </ul>

          	<div id="navbar-content" class="collapse navbar-collapse">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                  <a class="nav-link text-uppercase font-weight-bold" href="/" title=Home>Home</a>
                </li>
                <li class="nav-item active">
                  <a class="nav-link text-uppercase font-weight-bold" href="/security_blog/" title="Security Blog">Security Blog</a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
		<!-- End header -->

		<!-- Main content start -->
    <div class="container mt-5 pt-5">
      <main class="col-sm-10 mx-sm-auto">

      	<article class="post">
          <header>
            <h1>Weak RSA</h1>
            <span class="text-muted">Crypto challenge from HTB!</span><br>
            <span class="text-muted">

            	Posted <time datetime=2019-02-14&#32;EDT>Tue Feb 14 2019</time>

            </span>
            <br>
						<a href="/tags/challenges"><span class="badge badge-primary">challenges</span></a>
						<a href="/tags/challenges/crypto.html"><span class="badge badge-primary">crypto</span></a>

          </header>
          <hr>
          <section class="body">
            <p>Breaking the infamous RSA algorithm. It has been the gold standard for public-key cryptography. There's a catch though, if you implement it badly, your ciphertext is no longer safe. Given a few minutes and a bit of RSA knowledge should do the trick for this challenge. Read here for more information on this.
            </p>

            <figure class="post">
          	<img src="/assets/HTB_images/Challenges-Crypto/weakrsa/banner.PNG" class="img-responsive img-rounded">

      			</figure>

      			<h2 id="weakrsa">Your key is Public</h2>

      			<p>Before following this walkthrough, I highly recommend trying to get the flag yourself! Just like you will hear from everyone else, try harder! (if you cannot find it)</p>
      			<p>Follow this <a href="https://www.hackthebox.eu/home/challenges/Crypto">link</a> and download the file under Weak RSA section. You will have to login in order to do that.</p>

            <div class="highlight">
              <pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
                <code class="language-bash" data-lang="bash"><span style="color:#66d9ef">
htb@noone:~/crypto/weakrsa$</span> unzip weak-rsa.zip
Archive:  weak-rsa.zip
[weak-rsa.zip] flag.enc password:
  inflating: flag.enc
  inflating: key.pub<span style="color:#66d9ef">
htb@noone:~/crypto/weakrsa$</span></code>
              </pre>
            </div>
						<p>Well, so we have a two files. Let's try to open them.</p>
						<div class="highlight">
              <pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
                <code class="language-bash" data-lang="bash"><span style="color:#66d9ef">
htb@noone:~/crypto/weakrsa$</span> cat key.pub
-----BEGIN PUBLIC KEY-----
MIIBHzANBgkqhkiG9w0BAQEFAAOCAQwAMIIBBwKBgQMwO3kPsUnaNAbUlaubn7ip
4pNEXjvUOxjvLwUhtybr6Ng4undLtSQPCPf7ygoUKh1KYeqXMpTmhKjRos3xioTy
23CZuOl3WIsLiRKSVYyqBc9d8rxjNMXuUIOiNO38ealcR4p44zfHI66INPuKmTG3
RQP/6p5hv1PYcWmErEeDewKBgGEXxgRIsTlFGrW2C2JXoSvakMCWD60eAH0W2PpD
qlqqOFD8JA5UFK0roQkOjhLWSVu8c6DLpWJQQlXHPqP702qIg/gx2o0bm4EzrCEJ
4gYo6Ax+U7q6TOWhQpiBHnC0ojE8kUoqMhfALpUaruTJ6zmj8IA1e1M6bMqVF8sr
lb/N
-----END PUBLIC KEY-----<span style="color:#66d9ef">
htb@noone:~/crypto/weakrsa$</span>cat flag.enc
_vc[~kZ1Ĩ4I9V^G(+3Lu"$F0VP־j@|j{¾,YEXx,cN&Hl2Ӎ[o</code>
              </pre>
							<p>Looks like we have a public key which was used to produce the encrypted gibberish. Let's learn more about <a href="https://www.geeksforgeeks.org/rsa-algorithm-cryptography/">RSA</a>.</p>
							<p>We can derive from the reading that if the <code>p</code> and <code>q</code> values are smaller primes, we can break the RSA algorithm! That might be the case in this challenge (I hope!).</p>
							<p>A little Google Fu got me this <a href="https://github.com/Ganapati/RsaCtfTool">tool</a>. We can leverage it to try and decrypt the <code>flag.enc</code> file contents.</p>

						<div class="highlight">
              <pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
                <code class="language-bash" data-lang="bash"><span style="color:#66d9ef">
htb@noone:~/crypto/weakrsa$</span> python RsaCtfTool/RsaCtfTool.py --publickey key.pub --uncipherfile flag.enc
[+] Clear text : !ϲo@gX{Dn(Dx".,-)!6WQ+L~J9߬{_SDYCߚ4LU
   p/AHTB{s1mpl3*********4tt4ck}<span style="color:#66d9ef">
htb@noone:~/crypto/weakrsa$</span></code>
							</pre>
						</div>

			      <p>Voila! We have the FLAG and we can use this to gain out points on HackTheBox. Just copy paste it on the HackTheBox portal.</p>
			      <p>Happy Hacking! Cheers!</p>
					</section>
				</article>
			</main>
		</div>
		<!-- End main content -->

		<hr>

		<p class="text-center text-muted">
			&copy; SSP
		</p>
		<!-- End footer -->

	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
		integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
		integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
		integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
		integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k="
		crossorigin="anonymous"></script>
	<script type="application/javascript">
		var doNotTrack = false;
		if (!doNotTrack) {
		window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
		ga('create', 'UA-6650910-4', 'auto');
		ga('send', 'pageview');
		}
	</script>
	<script async src='https://www.google-analytics.com/analytics.js'></script>

	</body>
</html>
